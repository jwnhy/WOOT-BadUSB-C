\section{Introduction}
\label{sec:introduction}

The Universal Serial Bus (USB) protocol has become popular around the world
since its appearance, as it provides a unified and easy-to-use approach for a
large range of devices to communicate with each other.  From version 1.0 till
now, USB specification has evolved rapidly and offered more and more
functionalities.  Nowadays, devices with USB support are ubiquitous.

On the other side of the coin, the security of USB has caused serious problems.
The designers of the USB protocol did not care much about security issues as
they wanted to make an easy-to-use protocol.  There are more than four hundred
vulnerabilities referencing USB on CVE list~\cite{website:CVE-list}.  As a
result, many attackers exploit these vulnerabilities and the
\textit{trust-by-default} characteristics of USB to conduct attacks, which puts
the privacy and financial security of USB users in danger~\cite{sok}.

BadUSB is a well-known class of firmware attacks~\cite{badusb}.  These attacks
are conducted through modification of the device firmware, which will disguise
normal USB devices as other types of devices that are \textit{trust-by-default}
by the hosts.  Typical simulated devices include HID (short for human interface
devices, including keyboards, mice, etc.) and disks.  Utilizing BadUSB,
attackers can pretend themselves as normal users, typing malicious commands to
victim computers, downloading and executing malicious scripts, and copying out
private data from disks.  Such attacks can easily escape from traditional
anti-virus software since it is hard to distinguish them from normal USB
devices.

Despite the advantageous features of BadUSB, there exist several limitations as
follows.  (1) Attackers cannot conduct attacks precisely, which decreases the
capabilities of BadUSB attacks.  When performing attacks on another host, the
attackers can not obtain the current user interface (UI) status which limits
them from taking subsequent moves.  For example, it is hard for attackers to
locate specific functional UI patterns like buttons and links on victim
computers by disguising USB devices like mice.  That explains why typical
BadUSB attacks often only stay in the command line, using commands to download
malicious scripts for execution.  However, these attacks may be intercepted by
anti-virus software or firewall due to the usage of the host network.  (2) To
our best knowledge, existing BadUSB attacks only utilize the features of USB
2.0.  The release of USB 3.0 makes USB more powerful, with a higher
transmission rate for data and the support towards a larger range of
peripherals including DisplayPort, HDMI, PowerDelivery, etc.  BadUSB attacks
can become more effective with the help of newly supported features in USB 3.0.
(3) There have emerged multiple efficacious countermeasures after the
appearance of BadUSB.  For example, GoodUSB offers a defense method by limiting
the functions of USB devices to users' expectations~\cite{tian2015defending}.
It provides a graphical interface for users to describe the functionalities or
roles of the USB device and reject any usage beyond the description.
%\shuqing{Can't bypass USBCheckIn.}

In this work, we proposed our approach addressing the limitations mentioned
above and implemented a multi-mode attack model of USB, named \tool.  \tool
extends BadUSB to support the features of USB Type-C.  Since USB Type-C is
capable to transfer video stream data, \tool could obtain the information of
victim's graphical interface during attacks.  Combining it with the emulation
of traditional HIDs like keyboards and mice, attackers are capable of
performing precise attacks.  We did experiments to verify that \tool could also
bypass many countermeasures for BadUSB since they often rely on interaction
with the graphical interface.  Moreover, we implemented multiple attacking
modes of USB attacks based on our approach to verify its effectiveness,
including HID Emulator Mode, Video Capture Mode, and Full Control Mode.  To improve the
efficiency and performance of \tool, we designed a filtering algorithm to
preprocess the video data before network transmission.  Moreover, we conducted
a series of experiments for each attack mode as well as for different types of
devices, including smartphones, personal computers, and tablet computers, to
validate the usability of \tool.  We also conducted a user study for attacks in
sharing power banks, one of the application scenarios of \tool.  During the
user study, we obtained a large amount of sensitive data through \tool, since
users are usually unconscious of the necessity to check the USB devices they
plugged in for security purposes.  
10 volunteers are involved in the user study.
At last, we found that 4,796 of 94,058 records obtained by \tool are related to privacy information of users.
After the validation of our attack model, we
proposed several defense methods as countermeasures, including external
hardware authorization, distrust-by-default, etc.  It is worth noting that we
designed a method, called isolated UI rendering, to separate the user interface
into sensitive and insensitive layers.  Only content on the insensitive layer
will be passed to the insecure driver and thus rendered on the external
display, which protects content on the sensitive layer.
%\shuqing{Case study, evaluation, notable results.}

We summarize our key contributions as follows:

\begin{itemize} 
    
    \item To our best knowledge, this is the first work to utilize new features
	of USB Type-C.  The combination of new support with conventional BadUSB
	makes attacks more precise and effective.
	
    \item Our approach can bypass many previous countermeasures of BadUSB.
	
    \item We conducted multiple experiments and a user study to validate the
	usability and effectiveness of \tool.  We also proposed several
	countermeasures for our attack model, which are reasonable and
	insightful. 
	%\fengwei{Add countermeasures, in particular the isolation design.}
	%\shuqing{Isolated UI rendering is added in the last paragraph.}
\end{itemize}

The rest of this paper is structured as follows.  Section~\ref{sec:background}
provides the background of USB specification.  Section~\ref{sec:related_work}
introduces the existing work of USB security from the aspects of attacking and
defense respectively.  In Section~\ref{sec:badusb}, we present the threat model
and the overall implementation of \tool in three different modes.  The
experiments and user study we conducted are featured in
Section~\ref{sec:experiment}.  We present the possible countermeasures of \tool
in Section~\ref{sec:countermeasures}.  The limits and impacts of our approach
are discussed in Section~\ref{sec:discussion}, and the conclusion lies in
Section~\ref{sec:conclusion}.
%\shuqing{Fill in after the structure is finalized.}














