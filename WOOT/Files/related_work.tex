\section{Related Work}
\label{sec:related_work}
\hongyi{Move the stuff about USB protocol to Background}\\
\outline{Attack based on USB 1.0, briefly}\\
\outline{Attack based on USB 2.0, focus on works about application and transport layer}\\
\outline{Attack survey table}\\
\outline{Attack or current works about USB Type-C}\\

In this part, we survey related works on USB attack security in Section III-A, and USB defence security in Section III-B, respectively.

\subsection{USB Attack Security}
While many USB based  attacks have been developed, these attacks are all tied to the environment of the target devices. In addition, limited to the USB 2.0\cite{usb20} specification, there is no video transformation interface, the control of attack processing is impossibly handled by the attackers without additional processing signal received. When the  protocol masquerading attack devices, e.g., Rubbery Ducky\cite{rubber}, \cite{rubberducky2020} and USBderivery\cite{usbdriver}, are connected to the host, they will hide their own functionality with the re-write functionality interface, that works because of the HID enumeration property for USB identifying. Software running on the host will exfiltrate data or receive commands via the RF interface in \cite{turnip} after modified the USB table with an additional RF transmitter. Due to the limitations of USB 2.0, it is impossible to handle the real-time screen information of the host, so only environment fitted commands or data will work in these scenarios.

In a similar way, \cite{duqu} used a user-mode rootkit to hide malicious files on the USB storage device, zero-day exploits is also developed in \cite{zero-day} to automatically execute malware when the storage devices are connected to the host. Due to the limitation of functionality interface of devices for video transformation, the accuracy timing for wake up the devices is difficult to handle, e.g., executing the malicious code in host's free time, pause the execution processing in the inappropriate time. 

Another kind of attacks for USB to exfiltrate data\cite{smartphone}\cite{poweremi} and \cite{usbdriver} is to eavesdrop signal to recovered the sensitive data at the physical layer. Even though the data, including the video data, could be recovered in this way, the attack for executing malicious code is difficult to work, and the invisibility is a problem cannot be ignored due to the spacial locality of radio frequency. 

Since USB 3.1 was introduced with USB Type-C in 2013, display port and HDMI connectors have been provided by USB Type-C, transformation for video streaming data is guaranteed with the other attacks, e.g., protocol masquerading,  protocol corruption and code injection. 
\shuqing{Maybe duplicate with intro?}
To our best knowledge, we are the first to combine the host interaction with attack based on USB. Based on USB Type-C, we design Armory, a multi-mode BadUSB device\chaozu{add armory description} 


\chaozu{attack table}\\
\chaozu{enum diagram}

\subsection{USB Defence Security}

There are already some defense measures against USB attacks. Since USB devices may hide their real functionality from the user. GoodUSB\cite{tian2015defending} will report the functionality and identity information of the device to the user before the enumeration is completed. The user needs to explicitly specify the useful functionality of the device. On this basis, GoodUSB loads the corresponding driver for the device, and device can not request other drivers during enumeration or usage. This restricts the device from loading only the drivers allowed by the user, but does not prevent the device from using available drivers to attack. For example, a malicious keyboard can type commands without the user's knowledge after enumeration. What's more, in GoodUSB, VM is deployed in host to interact with the USB device to detect malicious behavior like automatic execution of malicious code.
 
IMonitor EAM\cite{IMonitor}\hongyi{Citation has compilation problem, plz recheck} maintain a whitelist of USB devices, only if one USB device is in the whitelist can it interact with host. This prevents all interactions between untrusted devices and the host. But this reduces the ease of use and requires users to have a certain safety awareness. For example, a naive user may add the USB device he found outdoors to his whitelist without precautions.

Google\cite{Googleukip} has developed a security tool for Linux systems that can prevent USB key injection attacks from malicious U disk devices by identifying suspicious keystroke speeds. This defense mechanism can be successful because the attacker cannot obtain the screen of the host based on the BadUSB under USB2.0, and can only inject instructions in a very short time to prevent the user from discovering. This leads to a very short interval between key events.

Some composite anti-virus systems, like Metascan\cite{OPSWAT} can sanitize the malicious files in the device to containment of any malware. However, Metascan warned users to be wary of the device plugged into the computer, since there is currently no way to ensure absolutely security.


