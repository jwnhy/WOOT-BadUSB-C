\section{Background}
\label{sec:background}
\noindent\outline{USB Standard}\\
We first introduce the development of USB specification and emphasize the key points adopted in our work.

\noindent\outline{USB1.x}\\
Proposed in 1996, USB 1.0\cite{usb10} was developed to provide an unified interface and thus reducing the cost of re-configuring the software. It is worth mentioning that as a polled-bus interface, all data transfers are initiated by the host.

USB1.x\cite{usb10}\cite{usb11} provided two data transfer rates which are Low Speed (1.5 Mbit/s) and Full Speed (12 MBit/s). At this point, due to the transfer limit, it only supports limited kinds of devices like keyboard, mice, etc.

\noindent\outline{USB2.0}\\
In 2000, USB 2.0\cite{usb20} specification was released. With High Speed (480 Mbit/s) mode introduced, printer, camera, CD-ROM drive and network cards were supported in this revision. Such high data transfer rate also gave rise to the popularity of ``flash drive'', portable device that allows physically transferring data around \cite{sok}. Though various peripherals were supported in USB 2.0, there was no reliable way to identify the type of a device. This security flaw allowed attacks like Rubber Ducky\cite{rubber}.

\noindent\outline{USB3.x}\\
USB 3.0\cite{usb30} was announced in 2008, with a Super Speed (5 Gbit/s) data transfer rate. Like its predecessor, more classes of peripherals were supported in this revision. In 2013, USB Type-C connector standard was introduced as a part of USB 3.1\cite{usb31}, providing a unified connector type for PowerDelivery (PD), Thunderbolt, DisplayPort and HDMI.  Yet no improvement of security was introduced in 3.x revisions, meaning any device claiming themselves as a monitor can capture the video stream from the host. Exposing such multi-propose connector unprotected is dangerous and allows attacks like our work \tool. In 2017, USB 3.2\cite{usb32} was released, doubling the data transfer rate. (20 Gbit/s)

\noindent\outline{Security Problem}\\
During the development of USB specification, security was rarely considered.  As the USB-IF believes it is the duty of original equipment manufacturers (OEMs) to decide whether security features should be implemented.\hongyi{Citation needed}. But the divergent implementations give chance for attack like Rubber Ducky\cite{rubber} and our \tool.